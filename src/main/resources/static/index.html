<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link rel="stylesheet" href="base.css">
    <title>Motorvognregister</title>
</head>
<body>
    <div class="egenskapDiv">
        <label for="personnummer">Personnummer</label>
        <br>
        <input type="text" id="personnummer">
    </div>
    <div class="egenskapDiv">
        <label for="navn">Navn</label>
        <br>
        <input type="text" id="navn">
    </div>
    <div class="egenskapDiv">
        <label for="adresse">Adresse</label>
        <br>
        <input type="text" id="adresse">
    </div>
    <div class="egenskapDiv">
        <label for="kjennetegn">Kjennetegn</label>
        <br>
        <input type="text" id="kjennetegn">
    </div>
    <div class="egenskapDiv">
        <label for="bilmerke">Bilmerke</label>
        <br>
        <input type="text" id="bilmerke">
    </div>
    <div class="egenskapDiv">
        <label for="biltype">Biltype</label>
        <br>
        <input type="text" id="biltype">
    </div>

    <br><br>
    <label for="registrer"></label>
    <button id="registrer">Registrer</button>

    <br><br>
    <label for="utMotorvogner">Alle motorvogner: </label>
    <div id="utMotorvogner"></div><br>

    <button id="slett">Slett alle motorvogner</button>

    <script type="application/javascript">
        // Lager et objekt, "motorvogn", med alle attributtene gitt
        $("#registrer").click(function() {
            const motorvogn = {
                personnummer: $("#personnummer").val(),
                navn: $("#navn").val(),
                adresse: $("#adresse").val(),
                kjennetegn: $("#kjennetegn").val(),
                bilmerke: $("#bilmerke").val(),
                biltype: $("#biltype").val()
            };

            // Sender en postmapping for å lagre "motorvogn" objektet
            $.post("/lagre", motorvogn, function() {
                hentAlle();
            });

            // Setter alle inputfeltene tomt
            $("#personnummer").val("");
            $("#navn").val("");
            $("#adresse").val("");
            $("#kjennetegn").val("");
            $("#bilmerke").val("");
            $("#biltype").val("");
        })

        // Sender en getmapping som henter alle motorvognene i registeret
        function hentAlle() {
            $.get("/hentAlle", function(data) {
                formaterData(data);
            })
        }

        // Lager en tabell som inneholder alle verdiene i motorvognregisteret
        function formaterData(motorvogner) {
            let ut = "<table> <tr>" +
                "<th>Personnummer</th>" +
                "<th>Navn</th>" +
                "<th>Adresse</th>" +
                "<th>Kjennetegn</th>" +
                "<th>Bilmerke</th>" +
                "<th>Biltype</th>" +
                "</tr>";

            for (const motorvogn of motorvogner) {
                ut += `<tr>
                       <td>${motorvogn.personnummer}</td>
                       <td>${motorvogn.navn}</td>
                       <td>${motorvogn.adresse}</td>
                       <td>${motorvogn.kjennetegn}</td>
                       <td>${motorvogn.bilmerke}</td>
                       <td>${motorvogn.biltype}</td>
                       </tr>`;
            }

            ut += "</table>";
            $("#utMotorvogner").html(ut);
        }

        // Sender en postmapping for å slette alt i registeret
        $("#slett").click(function() {
            $.post("/slett", function() {
                hentAlle();
            });
        })
    </script>
</body>
</html>